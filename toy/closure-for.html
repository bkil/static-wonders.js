<!DOCTYPE html>
<html>
<head>
  <meta charset=utf-8>
  <title>JavaScript closure for</title>
  <link rel='shortcut icon' type=image/x-icon href=data:image/x-icon;,>
  <meta name=viewport content='width=device-width, initial-scale=1.0'>
<body>
  <a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures#creating_closures_in_loops_a_common_mistake' rel=noopener>https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures#creating_closures_in_loops_a_common_mistake</a>
  <pre id=result></pre>

<script>
'use strict';
(function() {

  function main() {
    for (var i = 0; i < 4; i++) {
      printLater(function(){ return i; });
    }

    for (let j = 0; j < 4; j++) {
      printLater(function(){ return j; });
    }

    for (var k = 0; k < 4; k++) {
      printLater(
        (function(x) {
          return function() {
            return x;
          }
        })(k));
    }
  }

  function printLater(f) {
    setTimeout(
      function() {
        document.getElementById('result').innerText += f() + '\n';
      },
      0);
  }

main();
})();
</script>
</html>
